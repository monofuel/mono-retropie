---
- git:
    repo: https://github.com/RetroPie/RetroPie-Setup
    dest: /opt/RetroPie-Setup
    depth: 1
    update: yes
- name: install retropie deps
  apt: name={{item}} state=present
  with_items:
    # borrowed from https://github.com/Albiorix2016/rott
    # not sure what ones are actaully needed, but emulationstation doesn't start without some of these
    - automake
    - build-essential
    - ca-certificates
    - cmake
    - ffmpeg 
    - git
    - libavcodec-dev
    - libdrm-dev
    - libegl1-mesa-dev
    - libfreetype6-dev
    - libgbm-dev
    - libgles1-mesa
    - libgles1-mesa-dev
    - libgles2-mesa 
    - libgles2-mesa-dev
    - libpulse-dev
    - libsdl-image1.2-dev
    - libsdl2-dev
    - libtool
    - libx11-dev
    - libxext-dev
    - libxfixes-dev
    - libxkbcommon-dev
    - libxml2-dev
    - lsb-release
    - mesa-utils
    - pkg-config
    - subversion
    - x11proto-xf86dri-dev
    - xinput
    - xutils-dev
    - yasm 
    - zlib1g-dev
    - xmlstarlet
    - python-pyudev
# TODO setup retropie user
# TODO automate this
# run `__user=retropie ./retropie_setup.sh` manually and install core/main packages

#- shell: ./retropie_packages.sh
#  proxy_env:
#    __user: retropie
#  args:
#    chdir: /opt/RetroPie-Setup